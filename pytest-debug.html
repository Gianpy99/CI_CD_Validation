<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Pytest Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { border: 1px solid #ccc; margin: 10px 0; padding: 10px; }
        .button { background: #4caf50; color: white; padding: 10px; border: none; cursor: pointer; margin: 5px; }
        .button:hover { background: #45a049; }
        .hidden { display: none; }
        .result { background: #f0f0f0; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Pytest HTML Report Debug Test</h1>
    
    <div class="test-section">
        <h2>1. Test Base JavaScript</h2>
        <button id="test-js" class="button">Test JavaScript</button>
        <div id="js-result" class="result hidden"></div>
    </div>
    
    <div class="test-section">
        <h2>2. Test DOM Manipulation</h2>
        <button id="test-dom" class="button">Test DOM</button>
        <div id="test-content" class="hidden">Questo contenuto dovrebbe apparire/scomparire</div>
        <div id="dom-result" class="result hidden"></div>
    </div>
    
    <div class="test-section">
        <h2>3. Test Event Listeners</h2>
        <button id="test-events" class="button">Test Events</button>
        <div id="events-result" class="result hidden"></div>
    </div>
    
    <div class="test-section">
        <h2>4. Test Console Output</h2>
        <button id="test-console" class="button">Test Console</button>
        <div id="console-result" class="result hidden"></div>
        <p><strong>Controlla la console del browser (F12) per vedere i log</strong></p>
    </div>
    
    <div class="test-section">
        <h2>5. Simula Pytest HTML</h2>
        <button id="show_all_details" class="button">Show all details</button>
        <button id="hide_all_details" class="button">Hide all details</button>
        
        <table id="results-table" style="width: 100%; border-collapse: collapse; margin: 10px 0;">
            <tr class="collapsible" style="border: 1px solid #ccc;">
                <td class="col-result collapsed" style="padding: 8px; border: 1px solid #ccc;">Passed</td>
                <td style="padding: 8px; border: 1px solid #ccc;">test_example_1</td>
                <td style="padding: 8px; border: 1px solid #ccc;">1ms</td>
            </tr>
            <tr class="extras-row hidden" style="border: 1px solid #ccc;">
                <td colspan="3" style="padding: 8px; border: 1px solid #ccc; background: #f9f9f9;">
                    Dettagli del test - dovrebbe apparire/scomparire
                </td>
            </tr>
            <tr class="collapsible" style="border: 1px solid #ccc;">
                <td class="col-result collapsed" style="padding: 8px; border: 1px solid #ccc;">Passed</td>
                <td style="padding: 8px; border: 1px solid #ccc;">test_example_2</td>
                <td style="padding: 8px; border: 1px solid #ccc;">2ms</td>
            </tr>
            <tr class="extras-row hidden" style="border: 1px solid #ccc;">
                <td colspan="3" style="padding: 8px; border: 1px solid #ccc; background: #f9f9f9;">
                    Altri dettagli del test
                </td>
            </tr>
        </table>
        
        <div id="pytest-result" class="result hidden"></div>
    </div>

    <script>
        console.log('=== PYTEST DEBUG SCRIPT LOADED ===');
        
        // Test 1: Base JavaScript
        document.getElementById('test-js').addEventListener('click', function() {
            console.log('Test JavaScript clicked');
            const result = document.getElementById('js-result');
            result.textContent = 'JavaScript funziona! Timestamp: ' + new Date().toLocaleTimeString();
            result.classList.remove('hidden');
        });
        
        // Test 2: DOM Manipulation
        document.getElementById('test-dom').addEventListener('click', function() {
            console.log('Test DOM clicked');
            const content = document.getElementById('test-content');
            const result = document.getElementById('dom-result');
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                result.textContent = 'Contenuto mostrato';
            } else {
                content.classList.add('hidden');
                result.textContent = 'Contenuto nascosto';
            }
            result.classList.remove('hidden');
        });
        
        // Test 3: Event Listeners
        let clickCount = 0;
        document.getElementById('test-events').addEventListener('click', function() {
            clickCount++;
            console.log('Event test clicked, count:', clickCount);
            const result = document.getElementById('events-result');
            result.textContent = 'Event listener funziona! Clicks: ' + clickCount;
            result.classList.remove('hidden');
        });
        
        // Test 4: Console
        document.getElementById('test-console').addEventListener('click', function() {
            console.log('=== TEST CONSOLE ===');
            console.log('Questo è un log normale');
            console.warn('Questo è un warning');
            console.error('Questo è un errore di test (non preoccuparti)');
            console.log('JavaScript version:', navigator.userAgent);
            console.log('Document ready state:', document.readyState);
            
            const result = document.getElementById('console-result');
            result.textContent = 'Log inviati alla console - controlla F12!';
            result.classList.remove('hidden');
        });
        
        // Test 5: Simula Pytest HTML (versione semplificata)
        console.log('Setting up pytest simulation...');
        
        document.getElementById('show_all_details').addEventListener('click', function() {
            console.log('Show all details clicked');
            const extrasRows = document.querySelectorAll('.extras-row');
            const collapsedCells = document.querySelectorAll('.col-result.collapsed');
            
            console.log('Found extras rows:', extrasRows.length);
            console.log('Found collapsed cells:', collapsedCells.length);
            
            extrasRows.forEach(row => {
                row.classList.remove('hidden');
                console.log('Showing row:', row);
            });
            
            collapsedCells.forEach(cell => {
                cell.classList.remove('collapsed');
                console.log('Uncollapsing cell:', cell);
            });
            
            const result = document.getElementById('pytest-result');
            result.textContent = 'Show all details eseguito - ' + extrasRows.length + ' righe mostrate';
            result.classList.remove('hidden');
        });
        
        document.getElementById('hide_all_details').addEventListener('click', function() {
            console.log('Hide all details clicked');
            const extrasRows = document.querySelectorAll('.extras-row');
            const resultCells = document.querySelectorAll('.col-result');
            
            extrasRows.forEach(row => {
                row.classList.add('hidden');
            });
            
            resultCells.forEach(cell => {
                cell.classList.add('collapsed');
            });
            
            const result = document.getElementById('pytest-result');
            result.textContent = 'Hide all details eseguito - ' + extrasRows.length + ' righe nascoste';
            result.classList.remove('hidden');
        });
        
        console.log('=== PYTEST DEBUG SETUP COMPLETE ===');
    </script>
</body>
</html>
