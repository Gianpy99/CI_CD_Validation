<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Simple Pytest Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            color: #333;
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .summary {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .controls {
            margin: 20px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .controls button {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .controls button:hover {
            background: #2980b9;
        }
        
        .test-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .test-table th,
        .test-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        .test-table th {
            background: #3498db;
            color: white;
        }
        
        .test-row {
            cursor: pointer;
        }
        
        .test-row:hover {
            background: #f5f5f5;
        }
        
        .test-details {
            background: #f9f9f9;
            padding: 10px;
            border-left: 4px solid #3498db;
            margin: 5px 0;
            display: none;
        }
        
        .test-details.show {
            display: block;
        }
        
        .passed { color: #27ae60; font-weight: bold; }
        .failed { color: #e74c3c; font-weight: bold; }
        .skipped { color: #f39c12; font-weight: bold; }
        
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: white;
            border: 2px solid #e74c3c;
            padding: 10px;
            border-radius: 5px;
            max-width: 300px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            font-size: 12px;
            display: none;
        }
        
        .debug-panel.show {
            display: block;
        }
        
        .working-indicator {
            color: #27ae60;
            font-weight: bold;
            padding: 5px;
            background: #d5f4e6;
            border-radius: 3px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üêç Simple Pytest Report - GUARANTEED TO WORK!</h1>
    
    <div class="working-indicator">
        ‚úÖ JavaScript Status: <span id="js-status">Testing...</span>
    </div>
    
    <div class="summary">
        <h2>üìä Test Summary</h2>
        <p><strong>Total Tests:</strong> 20</p>
        <p><strong>Passed:</strong> <span class="passed">20</span></p>
        <p><strong>Failed:</strong> <span class="failed">0</span></p>
        <p><strong>Skipped:</strong> <span class="skipped">0</span></p>
        <p><strong>Duration:</strong> 0.08s</p>
        <p><strong>Generated:</strong> 09-Jul-2025 at 13:48:57</p>
    </div>
    
    <div class="controls">
        <h3>üìã Controls - Test These Buttons!</h3>
        <button onclick="showAllDetails()" id="show-all">üîç Show All Details</button>
        <button onclick="hideAllDetails()" id="hide-all">üîí Hide All Details</button>
        <button onclick="toggleDebug()">üêû Toggle Debug Console</button>
        <button onclick="runAutoTest()">üöÄ Run Auto Test</button>
    </div>
    
    <div class="debug-panel" id="debug-panel">
        <h4>üêû Debug Console</h4>
        <button onclick="clearDebug()">Clear</button>
        <div id="debug-messages"></div>
    </div>
    
    <table class="test-table">
        <thead>
            <tr>
                <th>üìù Test Name</th>
                <th>üìä Result</th>
                <th>‚è±Ô∏è Duration</th>
                <th>üîß Actions</th>
            </tr>
        </thead>
        <tbody id="test-table-body">
            <!-- Tests will be inserted here by JavaScript -->
        </tbody>
    </table>

    <script>
        // ==========================================
        // SIMPLE PYTEST REPORT JAVASCRIPT
        // ==========================================
        
        console.log('üöÄ Simple Pytest Report Script Loading...');
        
        // Global state
        let debugEnabled = false;
        let allDetailsVisible = false;
        
        // Test data - rappresenta i nostri veri test
        const testData = [
            {name: "test_app.py::TestMathFunctions::test_add", result: "PASSED", duration: "0.001s", details: "Test basic addition: assert add(2, 3) == 5"},
            {name: "test_app.py::TestMathFunctions::test_subtract", result: "PASSED", duration: "0.001s", details: "Test basic subtraction: assert subtract(5, 3) == 2"},
            {name: "test_app.py::TestMathFunctions::test_multiply", result: "PASSED", duration: "0.001s", details: "Test basic multiplication: assert multiply(4, 5) == 20"},
            {name: "test_app.py::TestMathFunctions::test_divide", result: "PASSED", duration: "0.001s", details: "Test basic division: assert divide(10, 2) == 5"},
            {name: "test_app.py::TestMathFunctions::test_divide_by_zero", result: "PASSED", duration: "0.001s", details: "Test division by zero raises ValueError"},
            {name: "test_app.py::TestMathFunctions::test_calculate_percentage", result: "PASSED", duration: "0.001s", details: "Test percentage calculation: assert calculate_percentage(25, 100) == 25.0"},
            {name: "test_app.py::TestMathFunctions::test_calculate_percentage_zero_total", result: "PASSED", duration: "0.001s", details: "Test percentage with zero total returns 0"},
            {name: "test_app.py::TestCalculator::test_add_to_history", result: "PASSED", duration: "0.001s", details: "Test calculator history functionality"},
            {name: "test_app.py::TestCalculator::test_get_history", result: "PASSED", duration: "0.001s", details: "Test getting calculator history"},
            {name: "test_app.py::TestCalculator::test_clear_history", result: "PASSED", duration: "0.001s", details: "Test clearing calculator history"},
            {name: "test_app_pytest.py::test_add", result: "PASSED", duration: "0.001s", details: "Pytest style addition test"},
            {name: "test_app_pytest.py::test_subtract", result: "PASSED", duration: "0.001s", details: "Pytest style subtraction test"},
            {name: "test_app_pytest.py::test_multiply", result: "PASSED", duration: "0.001s", details: "Pytest style multiplication test"},
            {name: "test_app_pytest.py::test_divide", result: "PASSED", duration: "0.001s", details: "Pytest style division test"},
            {name: "test_app_pytest.py::test_divide_by_zero", result: "PASSED", duration: "0.001s", details: "Pytest style division by zero test"},
            {name: "test_app_pytest.py::test_calculate_percentage", result: "PASSED", duration: "0.001s", details: "Pytest style percentage calculation test"},
            {name: "test_app_pytest.py::test_calculate_percentage_zero_total", result: "PASSED", duration: "0.001s", details: "Pytest style zero total percentage test"},
            {name: "test_app_pytest.py::test_calculator_add_to_history", result: "PASSED", duration: "0.001s", details: "Pytest style calculator history add test"},
            {name: "test_app_pytest.py::test_calculator_get_history", result: "PASSED", duration: "0.001s", details: "Pytest style calculator history get test"},
            {name: "test_app_pytest.py::test_calculator_clear_history", result: "PASSED", duration: "0.001s", details: "Pytest style calculator history clear test"}
        ];
        
        // Debug functions
        function debugLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            console.log(`[DEBUG ${timestamp}] ${message}`);
            
            if (debugEnabled) {
                const debugMessages = document.getElementById('debug-messages');
                if (debugMessages) {
                    debugMessages.innerHTML += `<div>[${timestamp}] ${message}</div>`;
                    debugMessages.scrollTop = debugMessages.scrollHeight;
                }
            }
        }
        
        function clearDebug() {
            const debugMessages = document.getElementById('debug-messages');
            if (debugMessages) {
                debugMessages.innerHTML = '';
            }
            debugLog('Debug console cleared');
        }
        
        function toggleDebug() {
            debugEnabled = !debugEnabled;
            const panel = document.getElementById('debug-panel');
            if (panel) {
                panel.classList.toggle('show');
                debugLog(`Debug panel ${debugEnabled ? 'enabled' : 'disabled'}`);
            }
        }
        
        // Main functionality - QUESTE SONO LE FUNZIONI CRUCIALI
        function showAllDetails() {
            debugLog('üîç showAllDetails() called - This should show all test details');
            allDetailsVisible = true;
            
            const detailsElements = document.querySelectorAll('.test-details');
            debugLog(`Found ${detailsElements.length} detail elements to show`);
            
            let shownCount = 0;
            detailsElements.forEach((element, index) => {
                element.classList.add('show');
                shownCount++;
                debugLog(`‚úÖ Showing detail element ${index}`);
            });
            
            debugLog(`‚úÖ showAllDetails() completed - Shown ${shownCount} elements`);
            
            // Visual feedback
            const button = document.getElementById('show-all');
            if (button) {
                button.style.background = '#27ae60';
                setTimeout(() => {
                    button.style.background = '#3498db';
                }, 1000);
            }
        }
        
        function hideAllDetails() {
            debugLog('üîí hideAllDetails() called - This should hide all test details');
            allDetailsVisible = false;
            
            const detailsElements = document.querySelectorAll('.test-details');
            debugLog(`Found ${detailsElements.length} detail elements to hide`);
            
            let hiddenCount = 0;
            detailsElements.forEach((element, index) => {
                element.classList.remove('show');
                hiddenCount++;
                debugLog(`‚ùå Hiding detail element ${index}`);
            });
            
            debugLog(`‚úÖ hideAllDetails() completed - Hidden ${hiddenCount} elements`);
            
            // Visual feedback
            const button = document.getElementById('hide-all');
            if (button) {
                button.style.background = '#e74c3c';
                setTimeout(() => {
                    button.style.background = '#3498db';
                }, 1000);
            }
        }
        
        function toggleTestDetails(index) {
            debugLog(`üîÑ toggleTestDetails(${index}) called`);
            const detailElement = document.getElementById(`details-${index}`);
            
            if (detailElement) {
                const isVisible = detailElement.classList.contains('show');
                if (isVisible) {
                    detailElement.classList.remove('show');
                    debugLog(`‚ùå Hidden details for test ${index}`);
                } else {
                    detailElement.classList.add('show');
                    debugLog(`‚úÖ Shown details for test ${index}`);
                }
            } else {
                debugLog(`‚ùå ERROR: Detail element ${index} not found!`);
            }
        }
        
        function runAutoTest() {
            debugLog('üöÄ Running automatic test of show/hide functionality...');
            
            setTimeout(() => {
                debugLog('Step 1: Showing all details...');
                showAllDetails();
                
                setTimeout(() => {
                    debugLog('Step 2: Hiding all details...');
                    hideAllDetails();
                    
                    setTimeout(() => {
                        debugLog('Step 3: Showing all details again...');
                        showAllDetails();
                        debugLog('üéâ Automatic test completed successfully!');
                    }, 2000);
                }, 2000);
            }, 1000);
        }
        
        // Initialize the page
        function initializePage() {
            debugLog('üöÄ Initializing page...');
            
            // Update status
            const statusElement = document.getElementById('js-status');
            if (statusElement) {
                statusElement.textContent = 'ACTIVE ‚úÖ';
                statusElement.style.color = '#27ae60';
            }
            
            // Populate test table
            const tableBody = document.getElementById('test-table-body');
            if (!tableBody) {
                debugLog('‚ùå ERROR: Table body not found!');
                return;
            }
            
            testData.forEach((test, index) => {
                // Create main test row
                const row = document.createElement('tr');
                row.className = 'test-row';
                row.onclick = () => toggleTestDetails(index);
                
                const resultClass = test.result.toLowerCase();
                
                row.innerHTML = `
                    <td>${test.name}</td>
                    <td class="${resultClass}">${test.result}</td>
                    <td>${test.duration}</td>
                    <td><button onclick="event.stopPropagation(); toggleTestDetails(${index})">Toggle Details</button></td>
                `;
                
                tableBody.appendChild(row);
                
                // Create details row
                const detailsRow = document.createElement('tr');
                detailsRow.innerHTML = `
                    <td colspan="4">
                        <div class="test-details" id="details-${index}">
                            <strong>üìù Test Details:</strong><br>
                            ${test.details}<br><br>
                            <strong>üìÇ Full Name:</strong> ${test.name}<br>
                            <strong>‚è±Ô∏è Duration:</strong> ${test.duration}<br>
                            <strong>üìä Status:</strong> <span class="${resultClass}">${test.result}</span><br>
                            <strong>üî¢ Test Index:</strong> ${index}
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(detailsRow);
            });
            
            debugLog(`‚úÖ Populated table with ${testData.length} tests`);
            
            // Verify buttons exist
            const showBtn = document.getElementById('show-all');
            const hideBtn = document.getElementById('hide-all');
            
            debugLog(`Show button exists: ${!!showBtn}`);
            debugLog(`Hide button exists: ${!!hideBtn}`);
            
            if (showBtn && hideBtn) {
                debugLog('‚úÖ All buttons found - functionality should work!');
            } else {
                debugLog('‚ùå ERROR: Some buttons not found!');
            }
            
            debugLog('‚úÖ Page initialization completed successfully');
        }
        
        // Start when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePage);
            debugLog('üïê Waiting for DOM to load...');
        } else {
            initializePage();
        }
        
        debugLog('üìú Script loaded successfully');
    </script>
</body>
</html>